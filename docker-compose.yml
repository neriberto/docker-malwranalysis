version: '3.3'

services:

#  clamd:
#    image : neriberto/clamav
#    hostname : clamd
#    networks:
#      - vipernet
#    volumes:
#      - clamav-config:/etc/clamav/
#      - clamav-socket:/run/clamav/

  viperweb:
    build: viper/
    image: neriberto/viper:prod
    hostname: viperweb
    networks:
      - vipernet
    ports:
      - "8080:8080"
    volumes:
        - viper-config:/root/.viper/
#    volumes_from:
#      - clamd
    command: viper-web -H 0.0.0.0

  nginx:
     image: nginx
     ports:
       - "80:80"
     volumes:
       - ./conf.d:/etc/nginx/conf.d
     networks:
       - vipernet
     depends_on:
       - viperweb

#  hg:
#    build: hg/
#    hostname: hg
#    networks:
#      - vipernet


volumes:
    # clamav-config:
    # clamav-socket:
    viper-config:

networks:
  vipernet:
    driver: bridge
